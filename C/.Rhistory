us <- read.csv2("../USStates.csv", header = TRUE, sep = ',')
View(us)
hist(us$Smokers)
hist(as.numeric(us$Smokers)
hist(as.numeric(us$Smokers))
str(us)
us <- read.csv("../USStates.csv", header = TRUE, sep = ',')
str(us)
hist(us$Smokers)
barplot(us$Smokers)
barplot(sort(us$Smokers))
barplot(us$Smokers)
hist(us$Smokers)
knitr::opts_chunk$set(echo = TRUE)
de_bilt <- read.table(file = "KNMI_20160831.txt", header = FALSE, skip = 12, sep = ',')
de_bilt <- read.table(file = "../KNMI_20160831.txt", header = FALSE, skip = 12, sep = ',')
names(de_bilt)<-c("station", "yyyymmdd", "rainfall")
head(de_bilt)
month<-substr(de_bilt$yyyymmdd, 5, 6)
sel<-month=="04"
y<-de_bilt$rainfall[sel]
summary(y)
y[y < 0]<-0
summary(y)
knitr::opts_chunk$set(echo = TRUE)
de_bilt <- read.table(file = '../KNMI_20160831.txt',header = FALSE, skip = 12,sep = ',')
names(de_bilt) <- c("station","yyymmdd","rainfall")
workers
workers <- read.table("../workers.txt", header = TRUE)
workers <- read.table("../workers.txt", header = TRUE)
workers
sindacato <- workers[workers$status == "union"]
sindacato <- workers[workers$status == "union",1]
senza.sindacato <- workers[workers$status != "union",1]
sindacato
senza.sindacato
sindacato <- workers[workers$status == "union",1]
senza.sindacato <- workers[workers$status != "union",1]
hist(sindacato)
hist(senza.sindacato)
library(fitdistrplus)
workers <- read.table("../workers.txt", header = TRUE)
fit.mle <- fitdist(sindacato,distr = "norm")
fit.mle
plot(fit.mle)
fit.gamma.mle <- fitdist(sindacato,distr = "gamma")
fit.gamma.mle <- fitdist(sindacato,distr = "gamma")
plot(fit.gamma.mle)
fit.gamma.mle <- fitdist(sindacato,distr = "gamma",start = c(0,0))
fit.gamma.mle <- fitdist(sindacato,distr = "gamma",from=c(0,0))
fit.gamma.mle <- fitdist(sindacato,distr = "gamma",start=c(0,0))
fit.gamma.mle <- fitdist(sindacato,distr = "gamma",min=c(0,0))
fit.gamma.mle <- fitdist(sindacato,distr = "gamma",from=c(0,0))
fit.gamma.mle <- fitdist(sindacato,distr = "gamma")
plot(fit.gamma.mle)
fit.gamma.mle
fit.norm.mle <- fitdist(sindacato,distr = "norm")
plot(fit.norm.mle)
fit.norm.mle
B <- 1000
var.boot.proc <- function(y){
return(y)
}
sindacato.values <- matrix(sample(B*length(sindacato),replace = TRUE),ncol = length(sindacato))
B <- 1000
var.boot.proc <- function(y){
return(y)
}
sindacato.values <- matrix(sample(B*length(sindacato),replace = TRUE),ncol = length(sindacato))
no.sindacato.values <- matrix(sample(B*length(senza.sindacato),replace = TRUE),ncol = length(senza.sindacato))
B <- 1000
sindacato.values <- matrix(sample(B*length(sindacato),replace = TRUE), ncol = length(sindacato))
no.sindacato.values <- matrix(sample(B*length(senza.sindacato),replace = TRUE), ncol = length(senza.sindacato))
boot.sindacato.estimatore <- apply(sindacato.values,1,mean)
boot.no.sindacato.estimatore <- apply(no.sindacato.values,1,mean)
boot.estimatore <- boot.sindacato.estimatore - boot.no.sindacato.estimatore
v.boot <- mean(boot.estimatore^2) - mean(boot.estimatore)^2
v.boot
B <- 1000
sindacato.values <- matrix(sample(sindacato, B*length(sindacato),replace = TRUE), ncol = length(sindacato))
no.sindacato.values <- matrix(sample(senza.sindacato, B*length(senza.sindacato),replace = TRUE), ncol = length(senza.sindacato))
boot.sindacato.estimatore <- apply(sindacato.values,1,mean)
boot.no.sindacato.estimatore <- apply(no.sindacato.values,1,mean)
boot.estimatore <- boot.sindacato.estimatore - boot.no.sindacato.estimatore
v.boot <- mean(boot.estimatore^2) - mean(boot.estimatore)^2
v.boot
B <- 1000
sindacato.values <- matrix(sample(sindacato, B*length(sindacato),replace = TRUE), ncol = length(sindacato))
no.sindacato.values <- matrix(sample(senza.sindacato, B*length(senza.sindacato),replace = TRUE), ncol = length(senza.sindacato))
boot.sindacato.estimatore <- apply(sindacato.values,1,mean)
boot.no.sindacato.estimatore <- apply(no.sindacato.values,1,mean)
boot.estimatore <- boot.sindacato.estimatore - boot.no.sindacato.estimatore
v.boot <- mean(boot.estimatore^2) - mean(boot.estimatore)^2
v.boot
B <- 1000
sindacato.values <- matrix(sample(sindacato, B*length(sindacato),replace = TRUE), ncol = length(sindacato))
no.sindacato.values <- matrix(sample(senza.sindacato, B*length(senza.sindacato),replace = TRUE), ncol = length(senza.sindacato))
boot.sindacato.estimatore <- apply(sindacato.values,1,mean)
boot.no.sindacato.estimatore <- apply(no.sindacato.values,1,mean)
boot.estimatore <- boot.sindacato.estimatore - boot.no.sindacato.estimatore
v.boot <- mean(boot.estimatore^2) - mean(boot.estimatore)^2
v.boot
prob <- function(y){
return(mean(y > 0))
}
combined <- c()
combined[1,] <- sindacato.values
prob <- function(y){
return(mean(y > 0))
}
combined <- data.frame(sindacato=sindacato.values,no.sindacato=no.sindacato.values)
combined
combined
prob <- function(y){
return(mean(y > 0))
}
boot.values.combined <- data.frame(sindacato=boot.sindacato.estimatore,no.sindacato=boot.no.sindacato.estimatore)
boot.values.combined
boot.values.combined
prob <- function(sindacato, no.sindacato){
return(sindacato - no.sindacato)
}
#boot.values.combined <- data.frame(sindacato=boot.sindacato.estimatore,no.sindacato=boot.no.sindacato.estimatore)
#boot.values.combined
boot.theta <- boot.sindacato.estimatore-boot.no.sindacato.estimatore
hist(boot.theta)
hist(boot.theta)
boot.theta
mean(boot.theta>0)
boot.theta <- boot.sindacato.estimatore-boot.no.sindacato.estimatore
mean(boot.theta>0)
boot.theta <- boot.sindacato.estimatore-boot.no.sindacato.estimatore
alpha <- 0.01
limiti <- quantile(boot.theta,prob=c(1-alpha/2,alpha/2))
boot.theta <- boot.sindacato.estimatore-boot.no.sindacato.estimatore
alpha <- 0.01
limiti <- quantile(boot.theta,prob=c(1-alpha/2,alpha/2))
limiti
boot.theta <- boot.sindacato.estimatore-boot.no.sindacato.estimatore
alpha <- 0.01
limiti <- quantile(boot.theta,prob=c(alpha/2,1-alpha/2))
limiti
boot.theta <- boot.sindacato.estimatore-boot.no.sindacato.estimatore
alpha <- 0.01
limiti <- quantile(boot.theta,prob=c(alpha/2,1-alpha/2))
limiti
boot.theta <- boot.sindacato.estimatore-boot.no.sindacato.estimatore
alpha <- 0.01
limiti <- quantile(boot.theta,prob=c(alpha/2,1-alpha/2))
limiti
library(fitdistrplus)
library(ggplot2)
workers <- read.table("../workers.txt", header = TRUE)
boot.theta <- boot.sindacato.estimatore-boot.no.sindacato.estimatore
alpha <- 0.01
limiti <- quantile(boot.theta,prob=c(alpha/2,1-alpha/2))
limiti
p <- ggplot(data.frame(y = boot.theta),aes(y))
p <- p + stat_density()
p
p <- ggplot(data.frame(y = boot.theta),aes(y))
p <- p + stat_density()
p <- p + geom_vline(limiti[1],col="red")
p <- p + geom_vline(limiti[2],col="red")
p <- p + geom_vline(xintercept = limiti,col="red")
p
alpha <- 0.05
limiti <- quantile(boot.theta,prob=c(alpha/2,1-alpha/2))
limiti
p <- ggplot(data.frame(y = boot.theta), aes(y))
p <- p + geom_vline(xintercept = limiti,col="red")
p
alpha <- 0.01
limiti <- quantile(boot.theta,prob=c(alpha/2,1-alpha/2))
limiti
p <- ggplot(data.frame(y = boot.theta), aes(y))
p <- p + stat_density()
p <- p + geom_vline(xintercept = limiti,col="red")
p
boot.theta <- boot.sindacato.estimatore-boot.no.sindacato.estimatore
alpha <- 0.05
limiti <- quantile(boot.theta,prob=c(alpha/2,1-alpha/2))
limiti
p <- ggplot(data.frame(y = boot.theta), aes(y))
p <- p + stat_density()
p <- p + geom_vline(xintercept = limiti,col="red")
p
boot.theta <- boot.sindacato.estimatore-boot.no.sindacato.estimatore
alpha <- 0.5
limiti <- quantile(boot.theta,prob=c(alpha/2,1-alpha/2))
limiti
p <- ggplot(data.frame(y = boot.theta), aes(y))
p <- p + stat_density()
p <- p + geom_vline(xintercept = limiti,col="red")
p
boot.theta <- boot.sindacato.estimatore-boot.no.sindacato.estimatore
alpha <- 0.01
limiti <- quantile(boot.theta,prob=c(alpha/2,1-alpha/2))
limiti
p <- ggplot(data.frame(y = boot.theta), aes(y))
p <- p + stat_density()
p <- p + geom_vline(xintercept = limiti,col="red")
p
B <- 1000
sindacato.values <- matrix(sample(sindacato, B*length(sindacato),replace = TRUE), ncol = length(sindacato))
no.sindacato.values <- matrix(sample(senza.sindacato, B*length(senza.sindacato),replace = TRUE), ncol = length(senza.sindacato))
boot.sindacato.estimatore <- apply(sindacato.values,1,mean)
boot.no.sindacato.estimatore <- apply(no.sindacato.values,1,mean)
boot.estimatore <- boot.sindacato.estimatore - boot.no.sindacato.estimatore
v.boot <- mean(boot.estimatore^2) - mean(boot.estimatore)^2
v.boot
mean(boot.theta>0)
boot.theta <- boot.sindacato.estimatore-boot.no.sindacato.estimatore
alpha <- 0.01
limiti <- quantile(boot.theta,prob=c(alpha/2,1-alpha/2))
limiti
p <- ggplot(data.frame(y = boot.theta), aes(y))
p <- p + stat_density()
p <- p + geom_vline(xintercept = limiti,col="red")
p
mean(boot.theta>0)
mean(boot.theta>0)
